<!DOCTYPE html>
<html>
  <head>
    <title>不動産マップアプリ</title>
    <meta charset="utf-8" />
    <style>
      #map {
        height: 100vh;
        width: 100vw;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <script>
      async function initMap() {
        const response = await fetch("https://script.google.com/macros/s/AKfycbxzneUTmR6A6ME3wQUiAmIMTPyzq-GBlKKxkOyrVGJek0-tcYj2A8CDP5W3v8zMDBDM-Q/exec");
        const data = await response.json();

        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 10,
          center: { lat: 26.2124, lng: 127.6809 }, // 沖縄
        });

        data.forEach(property => {
          const marker = new google.maps.Marker({
            position: { lat: property.lat, lng: property.lng },
            map,
            title: property.name
          });

          const infoWindow = new google.maps.InfoWindow({
            content: `
              <div>
                <strong>${property.name}</strong><br>
                <a href="${property.pdf}" target="_blank">📄 PDFを見る</a><br>
                ${property.price ? '価格: ' + property.price + '<br>' : ''}
                ${property.unit ? '坪単価: ' + property.unit + '<br>' : ''}
                ${property.source ? '紹介元: ' + property.source + '<br>' : ''}
                ${property.city && property.town ? '住所: ' + property.city + ' ' + property.town + '<br>' : ''}
                ${property.note ? '備考: ' + property.note : ''}
              </div>
            `
          });

          marker.addListener("click", () => {
            infoWindow.open(map, marker);
          });
        });
      }
    </script>

    <!-- 🔑 Google Maps APIキーは下記に貼り付け -->
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCYQnbLmcGyA0-2U5eEuLxYYeSDEn9z_nA&callback=initMap">
    </script>
  </body>
</html>
